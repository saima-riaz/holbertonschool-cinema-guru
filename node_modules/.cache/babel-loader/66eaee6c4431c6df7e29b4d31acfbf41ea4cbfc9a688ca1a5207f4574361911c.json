{"ast":null,"code":"var _jsxFileName = \"/Users/saima/Desktop/Full stack spe/holbertonschool-cinema-guru/src/routes/dashboard/HomePage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport \"./dashboard.css\";\nimport MovieCard from \"../../components/movies/MovieCard\";\nimport Filter from \"../../components/movies/Filter\";\nimport Button from \"../../components/general/Button\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst HomePage = () => {\n  _s();\n  const [movies, setMovies] = useState([]);\n  const [minYear, setMinYear] = useState(1970);\n  const [maxYear, setMaxYear] = useState(2022);\n  const [genres, setGenres] = useState([]);\n  const [sort, setSort] = useState(\"\");\n  const [title, setTitle] = useState(\"\");\n  const [page, setPage] = useState(1);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  // useCallback will memoize the loadMovies function and avoid unnecessary re-creations\n  const loadMovies = useCallback(async (pageNumber = 1) => {\n    const token = localStorage.getItem(\"accessToken\");\n    if (!token) {\n      setErrorMessage(\"You are not authenticated. Please log in.\");\n      return;\n    }\n    setLoading(true);\n    try {\n      var _response$data$titles;\n      const response = await axios.get(\"http://localhost:8000/api/titles/advancedsearch\", {\n        params: {\n          minYear,\n          maxYear,\n          genres: genres.length ? genres.join(\",\") : \"\",\n          title,\n          sort,\n          page: pageNumber\n        },\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (((_response$data$titles = response.data.titles) === null || _response$data$titles === void 0 ? void 0 : _response$data$titles.length) > 0) {\n        setMovies(prevMovies => pageNumber === 1 ? response.data.titles : [...prevMovies, ...response.data.titles]);\n        setErrorMessage(\"\");\n      } else if (pageNumber === 1) {\n        setErrorMessage(\"No movies found.\");\n      }\n    } catch (error) {\n      var _error$response;\n      console.error(\"Error fetching movies:\", error);\n      setErrorMessage(`Error fetching movies: ${((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) || \"Unknown error\"}`);\n    } finally {\n      setLoading(false);\n    }\n  }, [minYear, maxYear, genres, title, sort]); // Ensure dependencies are set properly\n\n  useEffect(() => {\n    setPage(1);\n    loadMovies(1);\n  }, [loadMovies]); // Use loadMovies in the dependency array\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard-content\",\n    children: [/*#__PURE__*/_jsxDEV(Filter, {\n      minYear: minYear,\n      setMinYear: setMinYear,\n      maxYear: maxYear,\n      setMaxYear: setMaxYear,\n      sort: sort,\n      setSort: setSort,\n      genres: genres,\n      setGenres: setGenres,\n      title: title,\n      setTitle: setTitle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error-message\",\n      children: errorMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 30\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading movies...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 25\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"movies-list\",\n      children: movies.map((movie, index) => /*#__PURE__*/_jsxDEV(MovieCard, {\n        movie: movie\n      }, `${movie.imdbId}-${index}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      label: \"Load More...\",\n      className: \"load-more-button\",\n      onClick: () => {\n        const nextPage = page + 1;\n        setPage(nextPage);\n        loadMovies(nextPage);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 9\n  }, this);\n};\n_s(HomePage, \"jszkd4Kz0bSdanlhsvvqsZf//8Q=\");\n_c = HomePage;\nexport default HomePage;\nvar _c;\n$RefreshReg$(_c, \"HomePage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","MovieCard","Filter","Button","axios","jsxDEV","_jsxDEV","HomePage","_s","movies","setMovies","minYear","setMinYear","maxYear","setMaxYear","genres","setGenres","sort","setSort","title","setTitle","page","setPage","loading","setLoading","errorMessage","setErrorMessage","loadMovies","pageNumber","token","localStorage","getItem","_response$data$titles","response","get","params","length","join","headers","Authorization","data","titles","prevMovies","error","_error$response","console","status","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","movie","index","imdbId","label","onClick","nextPage","_c","$RefreshReg$"],"sources":["/Users/saima/Desktop/Full stack spe/holbertonschool-cinema-guru/src/routes/dashboard/HomePage.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport \"./dashboard.css\";\nimport MovieCard from \"../../components/movies/MovieCard\";\nimport Filter from \"../../components/movies/Filter\";\nimport Button from \"../../components/general/Button\";\nimport axios from \"axios\";\n\nconst HomePage = () => {\n    const [movies, setMovies] = useState([]);\n    const [minYear, setMinYear] = useState(1970);\n    const [maxYear, setMaxYear] = useState(2022);\n    const [genres, setGenres] = useState([]);\n    const [sort, setSort] = useState(\"\");\n    const [title, setTitle] = useState(\"\");\n    const [page, setPage] = useState(1);\n    const [loading, setLoading] = useState(false);\n    const [errorMessage, setErrorMessage] = useState(\"\");\n\n    // useCallback will memoize the loadMovies function and avoid unnecessary re-creations\n    const loadMovies = useCallback(async (pageNumber = 1) => {\n        const token = localStorage.getItem(\"accessToken\");\n        if (!token) {\n            setErrorMessage(\"You are not authenticated. Please log in.\");\n            return;\n        }\n        setLoading(true);\n\n        try {\n            const response = await axios.get(\"http://localhost:8000/api/titles/advancedsearch\", {\n                params: {\n                    minYear,\n                    maxYear,\n                    genres: genres.length ? genres.join(\",\") : \"\",\n                    title,\n                    sort,\n                    page: pageNumber\n                },\n                headers: { Authorization: `Bearer ${token}` }\n            });\n\n            if (response.data.titles?.length > 0) {\n                setMovies(prevMovies => (pageNumber === 1 ? response.data.titles : [...prevMovies, ...response.data.titles]));\n                setErrorMessage(\"\");\n            } else if (pageNumber === 1) {\n                setErrorMessage(\"No movies found.\");\n            }\n        } catch (error) {\n            console.error(\"Error fetching movies:\", error);\n            setErrorMessage(`Error fetching movies: ${error.response?.status || \"Unknown error\"}`);\n        } finally {\n            setLoading(false);\n        }\n    }, [minYear, maxYear, genres, title, sort]); // Ensure dependencies are set properly\n\n    useEffect(() => {\n        setPage(1);\n        loadMovies(1);\n    }, [loadMovies]); // Use loadMovies in the dependency array\n\n    return (\n        <div className=\"dashboard-content\">\n            <Filter\n                minYear={minYear} setMinYear={setMinYear}\n                maxYear={maxYear} setMaxYear={setMaxYear}\n                sort={sort} setSort={setSort}\n                genres={genres} setGenres={setGenres}\n                title={title} setTitle={setTitle}\n            />\n            {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n            {loading && <p>Loading movies...</p>}\n            <ul className=\"movies-list\">\n                {movies.map((movie, index) => (\n                    <MovieCard key={`${movie.imdbId}-${index}`} movie={movie} />\n                ))}\n            </ul>\n            <Button label=\"Load More...\" className=\"load-more-button\" onClick={() => {\n                const nextPage = page + 1;\n                setPage(nextPage);\n                loadMovies(nextPage);\n            }} />\n        </div>\n    );\n};\n\nexport default HomePage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}